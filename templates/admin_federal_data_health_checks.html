{% extends "admin_federal_data_base.html" %}

{% block federal_content %}
  <section class="card stack">
    <h2>Health Checks</h2>
    <p class="small">Current service status for database and PACER integration prerequisites.</p>

    <div class="grid two">
      <article class="pcl-detail-card">
        <h3>Database</h3>
        <p>
          {% if db_ok %}
            <strong>Healthy</strong>
          {% else %}
            <strong>Unavailable</strong>
          {% endif %}
        </p>
        {% if db_error %}
          <pre class="code-block">{{ db_error }}</pre>
        {% endif %}
      </article>

      <article class="pcl-detail-card">
        <h3>PACER Environment</h3>
        <p>
          {% if pacer_env_ok %}
            <strong>Aligned</strong>
          {% else %}
            <strong>Mismatch</strong>
          {% endif %}
        </p>
        <p class="small">
          Auth env: {{ pacer_env_config.auth_env or "unknown" }}<br>
          PCL env: {{ pacer_env_config.pcl_env or "unknown" }}
        </p>
        {% if pacer_env_reason %}
          <pre class="code-block">{{ pacer_env_reason }}</pre>
        {% endif %}
      </article>

      <article class="pcl-detail-card">
        <h3>Service Token</h3>
        <p>
          {% if service_token_status.connected %}
            <strong>Connected</strong>
          {% else %}
            <strong>Missing</strong>
          {% endif %}
        </p>
        <p class="small">
          Env: {{ service_token_status.environment_label }}<br>
          Fingerprint: {{ service_token_status.fingerprint or "none" }}
        </p>
      </article>

      <article class="pcl-detail-card">
        <h3>PCL Courts Catalog</h3>
        <p>
          {% if pcl_courts_count is not none and pcl_courts_count > 0 %}
            <strong>Loaded</strong>
          {% else %}
            <strong>Missing</strong>
          {% endif %}
        </p>
        {% if pcl_courts_count is not none %}
          <p class="small">Rows: {{ pcl_courts_count }}</p>
        {% endif %}
        {% if pcl_courts_error %}
          <pre class="code-block">{{ pcl_courts_error }}</pre>
        {% endif %}
        <p class="small">
          This catalog is required to validate court IDs during PACER batch downloads.
        </p>
      </article>
    </div>
  </section>
{% endblock %}
